<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 15.1.0.0" /><title></title></head><body><div><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">//²Ëµ¥Ïî  Ñ­»·</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">http://www.runoob.com/try/demo_source/bootstrap-modal.htm#</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&lt;ul&gt;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">for(int i=0;i&lt;modle.count;i++){</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">&lt;/li&gt;   &lt;a href="@model.name"&gt;&lt;/a&gt;&lt;/li&gt;</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">C:\Users\yaols\Documents\Tencent Files\465212602\FileRecv</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ÕËºÅ£ºd674936577</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ÃÜÂë£ºhujian1996</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ËùÔÚÇø·þ£º1439</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">612:662</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">523414741</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">472805</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">472806</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">sg168714lno</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">sg364792zqm</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">7E74FDB2DE4B8582A686FA433DE1B03A</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ËÞÃüÔÚ¾À½á   634:655</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">1322726135</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">UNL006</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">12345678a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GZYX0008</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">12345678a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">HUANGJIANa</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">12345678</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">3310808953@qq.com  8832135</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">38315168@qq.com 306618057</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">1305232470@qq.com  8832135</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">e62297517@sina.com a332211</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">R1209074772 815816</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">gzyx0001   12345678a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">12090747721 815816</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">liouhe5201314 123789</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ÉóºË°æ£¨Áìµ¼ÓÃ£© http://adobe.ly/24b3w93</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Êé¼ÇÔ±°æ  http://adobe.ly/1sexKMz</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">d267340964</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">8832135</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">132 132 44 764 100</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">147 100</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ÑòÍÕ 2059</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Ã« 2191</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Ò¦ 1427</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ºÎ 1577</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">moumouzhuan@163.com</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">liuzhuan1</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">13318034552</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Xiao103639</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">15227292554ÃÜÂë£ºhh614331</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&lt;/ul&gt;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">²Ëµ¥</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">²Ëµ¥Ò»</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">²Ëµ¥¶þ  Õâ¸ö³¬Á´Á¬½Ó  ÎÒÒª´«ÈëID½øÈ¥£¬ÆäËû³¬Á¬½Ó²»ÓÃ´«Èë</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">²Ëµ¥Èý</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">¶þ¼¶²Ëµ¥</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">¶þ¼¶²Ëµ¥1</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">¶þ¼¶²Ëµ¥2</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">http://bbs.itheima.com/thread-152557-1-1.html</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">UserTrain</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">id    userId  TrainId  GroupId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">1001  14848   null     null</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">1002  14848   242      null</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">UserGroup</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">id UserTrainId    GroupId</span></p><p style="margin:0pt 0pt 0pt 18.9pt; text-indent:-18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0; </span><span style="font-family:'Courier New'; font-size:10.5pt">1001           805</span></p><p style="margin:0pt; padding-left:18.9pt; text-indent:-18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt; padding-left:18.9pt; text-indent:-18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Group</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Id   name</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">805  ÖÊ¼ì×Ü¾Ö</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">with Temp AS(select a.Id,CoursewareId,VisitTime,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Delay,b.LessonType from dbo.CoursewareAct a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join dbo.V_Lesson2 b on a.LessonId=b.Id</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where UserId=14372 and TrainId=242 and (LessonId is not null)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select *from (select Row_Number() over(order by t.VisitTime desc) as RowId,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">t.Id,t.CoursewareId,ClassId,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">Title,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">t.VisitTime,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">VisitIp,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">UserId,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">UserName,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">Token,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">t.Delay,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">(select Hour from dbo.CoursewareDetail where Id=t.CoursewareId) as Hour,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">(select SUM(Delay) from Temp where CoursewareId=t.CoursewareId) as TotalDelay,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">(select count(Id) from Temp where CoursewareId=t.CoursewareId) as Total,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">LessonId,</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">t.LessonType</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">from Temp t join dbo.CoursewareAct a on t.Id=a.Id</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">where not exists(select 1 from Temp tt where tt.CoursewareId=t.CoursewareId and tt.VisitTime&gt;t.VisitTime)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">)as aaa</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">where RowId between 1 and 10 order by RowId</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">USE [aqsiq]</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">/****** Object:  StoredProcedure [dbo].[w_LearningPointCompanyByCount]    Script Date: 05/27/2015 16:36:05 ******/</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">SET ANSI_NULLS ON</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">SET QUOTED_IDENTIFIER ON</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- =============================================</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Author:Ò¦ÁúÉú</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Create date: 20150527</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Description:</span><span style="width:13.48pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">Ñ§Ï°µã¹ÜÀíÔ±  Çø·Ö±ØÐÞºÍÑ¡ÐÞµ¥Î»Í³¼Æ±í</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- =============================================</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ALTER PROCEDURE [dbo].[w_LearningPointCompanyByCount]</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt 0pt 0pt 37.8pt"><span style="font-family:'Courier New'; font-size:10.5pt">@StartRowIndex int,</span><span style="width:22.48pt; text-indent:0pt; display:inline-block"></span><span style="width:36pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">--ÆðÊ¼ÐÐË÷Òý</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@EndRowIndex int,</span><span style="width:11.68pt; text-indent:0pt; display:inline-block"></span><span style="width:36pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">--½áÊøÐÐË÷Òý</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@GroupId int,</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@Depth int,</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@UserName nvarchar(50),</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@Name nvarchar(50),</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@Year int,</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@OrderExp nvarchar(100)='',</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@LessonType int, --¿Î³ÌÀàÐÍ</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@IsCount tinyint</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">AS</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">BEGIN</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">declare</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">@SQLWhere nvarchar(1024),</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">@SQL nvarchar(2014)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQL='';</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQLWhere=' CreateYear='+CAST(@Year as varchar(4));</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@GroupId is null)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @GroupId=0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@Depth is null)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @Depth=1;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@Name&lt;&gt;'')</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">begin</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQLWhere=@SQLWhere +' and Name like ''%''+@Name+''%''';</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@UserName&lt;&gt;'')</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">begin</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQLWhere=@SQLWhere +' and UserName like ''%''+@UserName+''%''';</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">create table #bt(GroupName nvarchar(100),Hours int,UserId int,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">UserName nvarchar(100),RowId int,Name nvarchar(100),GroupId int,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Delay int,CreateYear int);</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">--0 ²éÑ¯×ÜÊý   1²éÏêÏ¸Êý¾Ý</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">with t1</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select ClassId,OrderId,Depth from GroupSort(21) where Depth&lt;=3</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">,t2 as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select RowId,a.UserId,UserName,Name,a.GroupId,b.CreateYear from (</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select Row_Number() over(order by  d.OrderId) as RowId,a.UserId,a.UserName,a.Name,c.GroupId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from [User] a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">join UserGroupMap c on c.UserId=a.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">join t1 d on d.ClassId=c.GroupId) as a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">inner join(select ut.UserId,Train.CreateYear</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from UserTrain ut join Train on ut.TrainId=Train.Id) as b</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">on a.UserId=b.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where a.RowId between 1 and 10</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bHours as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">--¸ù¾ÝÑ§Éú »®·Ö×¨Ìâ  Í³¼Æ±ØÐÞ¿ÎÑ§Ê±</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select ut.UserId,ld.LessonType,sum(cwd.Hour) as bhour</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from UserTrain ut</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">inner join LessonClass lc on ut.TrainId=lc.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonDetail ld on lc.ClassId=ld.ClassId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonCourseware lcw on ld.Id=lcw.LessonId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join CoursewareDetail cwd on lcw.CoursewareId=cwd.Id</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where LessonType=0</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by ut.UserId,ld.LessonType</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bComplete as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">--±ØÐÞ¿ÎÍê³ÉÑ§Ê±</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select ut.UserId,sum(ca.Delay) as Delay from UserTrain ut</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join CoursewareAct ca on ut.UserId=ca.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonDetail ld on ca.LessonId=ld.Id</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonClass lc on ld.ClassId=lc.ClassId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where ld.LessonType=0</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by ut.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">insert into #bt</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select (select ClassName from [Group] aa where aa.ClassId=t2.GroupId ) as GroupName,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bHours.bhour,t2.UserId,t2.UserName,t2.RowId,t2.Name,t2.GroupId,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bComplete.Delay bDelay,t2.CreateYear</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from t2</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join bHours on bHours.UserId=t2.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join bComplete on bComplete.UserId=t2.UserId;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQL='select RowId,GroupName,Hours,</span></p><p style="margin:0pt 0pt 0pt 63pt"><span style="font-family:'Courier New'; font-size:10.5pt">UserId,UserName,Name,GroupId,Delay,CreateYear from #bt</span></p><p style="margin:0pt 0pt 0pt 88.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">'</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@SQLWhere&lt;&gt;'')</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">begin</span></p><p style="margin:0pt 0pt 0pt 31.5pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQL=@SQL+' where '+@SQLWhere;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">exec(@SQL)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">USE [aqsiq]</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">/****** Object:  StoredProcedure [dbo].[w_CompanyLessonByPeople]    Script Date: 06/03/2015 18:46:10 ******/</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">SET ANSI_NULLS ON</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">SET QUOTED_IDENTIFIER ON</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- =============================================</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Author:Ò¦ÁúÉú</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Create date:20150603</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Description:Ñ§Ï°µã¹ÜÀíÔ± µ¥Î»Í³¼Æ</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- =============================================</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ALTER PROCEDURE [dbo].[w_CompanyLessonByPeople]</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt 0pt 0pt 37.8pt"><span style="font-family:'Courier New'; font-size:10.5pt">@StartRowIndex int,</span><span style="width:22.48pt; text-indent:0pt; display:inline-block"></span><span style="width:36pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">--ÆðÊ¼ÐÐË÷Òý</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@EndRowIndex int,</span><span style="width:11.68pt; text-indent:0pt; display:inline-block"></span><span style="width:36pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">--½áÊøÐÐË÷Òý</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@GroupId int,</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@Depth int,</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@Name nvarchar(50)='',</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@LessonType int, --¿Î³ÌÀàÐÍ</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@IsCount tinyint</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">AS</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">declare</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">@SQLWhere nvarchar(max),</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">@SQL nvarchar(max)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQLWhere='';</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@GroupId is null)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @GroupId=0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@Depth is null)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @Depth=1;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@Name&lt;&gt;'')</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">begin</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQLWhere=@SQLWhere +' and Name like '''+@Name+'%''';</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@LessonType&lt;&gt;3)</span></p><p style="margin:0pt 0pt 0pt 31.5pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQLWhere=@SQLWhere+' and LessonType='+cast(@LessonType as varchar(10))</span></p><p style="margin:0pt 0pt 0pt 31.5pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQL=';</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">with t1</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select ClassId,OrderId,Depth from GroupSort('+CAST(@GroupId as varchar(10))+') where Depth&lt;=3</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">,t2 as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select a.UserId,UserName,Name,a.GroupId,b.CreateYear,b.TrainId,trainName from (</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select a.UserId,a.UserName,a.Name,c.GroupId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from [User] a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">join UserGroupMap c on c.UserId=a.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">join t1 d on d.ClassId=c.GroupId) as a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join(select ut.UserId,Train.CreateYear,ut.TrainId,Train.Name trainName</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from UserTrain ut join Train on ut.TrainId=Train.Id) as b</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">on a.UserId=b.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bHours as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">--¸ù¾ÝÑ§Éú »®·Ö×¨Ìâ  Í³¼Æ±ØÐÞ¿ÎÑ§Ê±</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select ut.UserId,ld.LessonType,sum(cwd.Hour) as bhour,lc.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from UserTrain ut</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">inner join LessonClass lc on ut.TrainId=lc.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonDetail ld on lc.ClassId=ld.ClassId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonCourseware lcw on ld.Id=lcw.LessonId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join CoursewareDetail cwd on lcw.CoursewareId=cwd.Id</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where LessonType=0</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by ut.UserId,ld.LessonType,lc.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bComplete as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">--±ØÐÞ¿ÎÍê³ÉÑ§Ê±</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select ut.UserId,sum(ca.Delay) as Delay,lc.TrainId from UserTrain ut</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join CoursewareAct ca on ut.UserId=ca.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonDetail ld on ca.LessonId=ld.Id</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonClass lc on ld.ClassId=lc.ClassId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where ld.LessonType=0</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by ut.UserId,lc.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bt as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select (select ClassName from [Group] aa where aa.ClassId=t2.GroupId) as GroupName,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bHours.bhour hour,t2.UserId,t2.UserName,t2.Name,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bComplete.Delay Delay,t2.CreateYear,0 as LessonType</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from t2</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join bHours on bHours.UserId=t2.UserId and bHours.TrainId=t2.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join bComplete on bComplete.UserId=t2.UserId and bComplete.TrainId=t2.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">,xHours as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">--¸ù¾ÝÑ§Éú »®·Ö×¨Ìâ  Í³¼ÆÑ¡ÐÞ¿ÎÑ§Ê±</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select ut.UserId,sum(cwd.Hour) as xhour,lc.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from UserTrain ut</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">inner join LessonOptional lo on ut.Id=lo.UserTrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonDetail ld on ld.Id=lo.LessonId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonClass lc on lc.ClassId=ld.ClassId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonCourseware lcw on ld.Id=lcw.LessonId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join CoursewareDetail cwd on lcw.CoursewareId=cwd.Id</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where LessonType=1</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by ut.UserId,ld.LessonType,lc.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">xComplete as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">--Ñ¡ÐÞ¿ÎÍê³ÉÑ§Ê±</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select ut.UserId,sum(ca.Delay) as Delay,ut.TrainId from UserTrain ut</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">inner join LessonOptional lo on ut.Id=lo.UserTrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">inner join CoursewareAct ca on ut.UserId=ca.UserId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by ut.UserId,ut.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">xt as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select (select ClassName from [Group] aa where aa.ClassId=t2.GroupId) as GroupName,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">xHours.xhour hour,t2.UserId,t2.UserName,t2.Name,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">xComplete.Delay Delay,CreateYear,1 as LessonType</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from t2</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join xHours on xHours.UserId=t2.UserId and t2.TrainId=xHours.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join xComplete on xComplete.UserId=t2.UserId and t2.TrainId=xComplete.TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">bTatol as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select UserId,Name,UserName,sum(Delay) delay,sum(hour) hour,LessonType,GroupName from  bt</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by UserId,Name,LessonType,UserName,GroupName</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">xTatol as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select UserId,Name,UserName,sum(Delay) delay,sum(hour) hour,LessonType,GroupName from  xt</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by UserId,Name,LessonType,UserName,GroupName</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">Total as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select UserId,Name,UserName,delay,hour,LessonType,GroupName from bTatol</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">union</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select UserId,Name,UserName,delay,hour,LessonType,GroupName from xTatol</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt 0pt 0pt 6.3pt"><span style="font-family:'Courier New'; font-size:10.5pt">t as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select Row_Number() over(order by  UserId) as RowId,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">UserId,Name,UserName,delay,hour,LessonType,GroupName from Total'</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@SQLWhere&lt;&gt;'')</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQL=@SQL+' where 1=1'+@SQLWhere</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(@IsCount=0)</span></p><p style="margin:0pt 0pt 0pt 12.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">begin</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQL=@SQL+' ) select COUNT(1) from t'</span></p><p style="margin:0pt 0pt 0pt 12.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">else</span></p><p style="margin:0pt 0pt 0pt 12.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">begin</span></p><p style="margin:0pt 0pt 0pt 18.9pt"><span style="font-family:'Courier New'; font-size:10.5pt">set @SQL=@SQL+' ) select RowId,UserId,Name,UserName,</span></p><p style="margin:0pt 0pt 0pt 44.1pt"><span style="font-family:'Courier New'; font-size:10.5pt">delay,hour,LessonType,</span></p><p style="margin:0pt 0pt 0pt 44.1pt"><span style="font-family:'Courier New'; font-size:10.5pt">GroupName from t where RowId between '+CAST(@StartRowIndex as varchar(20))+' and '+CAST(@EndRowIndex as varchar(20))</span></p><p style="margin:0pt 0pt 0pt 12.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">exec(@sql)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">USE [aqsiq2]</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">/****** Object:  StoredProcedure [dbo].[w_GetTrainByStudentLessonHourList]    Script Date: 06/24/2015 13:45:54 ******/</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">SET ANSI_NULLS ON</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">SET QUOTED_IDENTIFIER ON</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">GO</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- =============================================</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Author:</span><span style="width:8.99pt; text-indent:0pt; display:inline-block"></span><span style="width:36pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">&lt;Author,,Name&gt;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Create date: &lt;Create Date,,&gt;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- Description:</span><span style="width:13.48pt; text-indent:0pt; display:inline-block"></span><span style="font-family:'Courier New'; font-size:10.5pt">&lt;Description,,&gt;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">-- =============================================</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ALTER PROCEDURE [dbo].[w_GetTrainByStudentLessonHourList]</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@UserId int,-- µ±Ç°·ÃÎÊÓÃ»§±àºÅ</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@TrainId nvarchar(1024),</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@RowCount int, --ÏÔÊ¾ÌõÊý</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@Role int, --½ÇÉ«  0£º·ÇÑ§Ô±  1Ñ§Ô±</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">@IsCount tinyint</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">AS</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">if @Role=0</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">begin</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">with bt as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select v.LessonId,ld.Title,lc.TrainId,v.Id as CoursewareId,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">v.[Hour],ld.OrderId,ld.AddTime from LessonDetail ld</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join dbo.V_Courseware v on ld.Id=v.LessonId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join dbo.LessonClass lc on ld.ClassId=lc.ClassId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where lc.TrainId=@TrainId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">btemp as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select bt.LessonId,bt.CoursewareId,MAX(a.VisitTime) as VisitTime,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(case when bt.[Hour]&gt;SUM(ISNull([Delay],0)) then SUM(ISNull([Delay],0))</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">else bt.[Hour] end) as [Delay],bt.[Hour],MIN(bt.Title) as Title,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bt.orderId,bt.addtime</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from (select * from CoursewareAct a  where a.LessonId is not null and a.UserId=@UserId) a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">right join bt on a.LessonId=bt.LessonId and a.CoursewareId=bt.CoursewareId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by bt.LessonId,bt.CoursewareId,bt.[Hour],bt.orderId,bt.addtime</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select top(@RowCount) MIN(btemp.Title) as Title,MAX(VisitTime) as LastTime,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ISNULL(SUM(ISNULL([Delay],0)),0) as TotalDelay,Isnull(SUM(ISNULL(btemp.[Hour],0)),0) as TotalHour,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">btemp.LessonId,0 as LessonType from btemp</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by LessonId,orderId,addtime</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">else</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">begin</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">with xt as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select lo.LessonId,ld.Title,ut.TrainId,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">v.Id as CoursewareId,v.[Hour],lo.Id as loId,ld.Teacher</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from LessonOptional lo</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join UserTrain ut on lo.UserTrainId=ut.Id</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join LessonDetail ld on ld.Id=lo.LessonId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">join dbo.V_Courseware v on lo.LessonId=v.LessonId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where ut.UserId=@UserId and ut.TrainId=@TrainId and ld.LessonType=1</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">xtemp as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select xt.LessonId,xt.CoursewareId,MAX(a.VisitTime) as VisitTime,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(case when xt.[Hour]&gt;SUM(ISNull([Delay],0)) then SUM(ISNull([Delay],0))</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">else xt.[Hour] end) as [Delay],xt.[Hour],MIN(xt.Title) as Title,xt.loId,xt.Teacher</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from (select LessonId,UserId,Delay,VisitTime,CoursewareId from CoursewareAct a  where a.LessonId is not null and a.UserId=73981) a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">right join  xt on a.LessonId=xt.LessonId and a.CoursewareId=xt.CoursewareId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by xt.LessonId,xt.CoursewareId,xt.[Hour],xt.loId,xt.Teacher</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">--Ñ¡ÐÞ¿Î</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">x as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select MIN(xtemp.Title) as Title,Teacher,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">MAX(VisitTime) as LastTime,ISNULL(SUM(ISNULL([Delay],0)),0) as TotalDelay,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Isnull(SUM(ISNULL(xtemp.[Hour],0)),0) as TotalHour,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">xtemp.LessonId,1 as LessonType,xtemp.loId from xtemp</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by LessonId,xtemp.loId,Teacher</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bt as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select v.LessonId,ld.Title,lc.TrainId,v.Id as CoursewareId,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">v.[Hour],ld.OrderId,ld.AddTime,ld.Teacher from LessonDetail ld</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join dbo.V_Courseware v on ld.Id=v.LessonId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">left join dbo.LessonClass lc on ld.ClassId=lc.ClassId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">where lc.TrainId=@TrainId and ld.LessonType=0</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">btemp as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select bt.LessonId,bt.CoursewareId,MAX(a.VisitTime) as VisitTime,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(case when bt.[Hour]&gt;SUM(ISNull([Delay],0)) then SUM(ISNull([Delay],0))</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">else bt.[Hour] end) as [Delay],bt.[Hour],MIN(bt.Title) as Title,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">bt.orderId,bt.addtime,bt.Teacher</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">from (select LessonId,CoursewareId,[Delay],VisitTime from CoursewareAct a  where a.LessonId is not null and a.UserId=@UserId) a</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">right join bt on a.LessonId=bt.LessonId and a.CoursewareId=bt.CoursewareId</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by bt.LessonId,bt.CoursewareId,bt.[Hour],bt.orderId,bt.addtime,bt.Teacher</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">b as(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select MIN(btemp.Title) as Title,Teacher,MAX(VisitTime) as LastTime,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">ISNULL(SUM(ISNULL([Delay],0)),0) as TotalDelay,Isnull(SUM(ISNULL(btemp.[Hour],0)),0) as TotalHour,</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">btemp.LessonId,0 as LessonType,0 as loId from btemp</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">group by LessonId,orderId,addtime,Teacher</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">),</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">temp as</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">(</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select top (@RowCount) Title,Teacher,LastTime,TotalDelay,TotalHour,LessonId,LessonType,loId from b</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">union</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select top(@RowCount) Title,Teacher,LastTime,TotalDelay,TotalHour,LessonId,LessonType,loId from x</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">select Title,Teacher,LastTime,TotalDelay,TotalHour,LessonId,LessonType,loId from temp;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">end</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">function getAPIHandle()</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">return apiHandle==null&amp;&amp;getAPI(),apiHandle</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">function findAPI(n)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">while(n.API==null&amp;&amp;n.parent!=null&amp;&amp;n.parent!=n)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(findAPITries++,findAPITries&gt;7)</span></p><p style="margin:0pt 0pt 0pt 75.6pt"><span style="font-family:'Courier New'; font-size:10.5pt">return null;</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">n=n.parent</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">return n.API</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">function getAPI()</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">var n=findAPI(window);</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">n==null&amp;&amp;window.opener!=null&amp;&amp;typeof opener!="undefined"&amp;&amp;(n=findAPI(window.opener));</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">n==null&amp;&amp;top.window.opener!=null&amp;&amp;typeof top.window.opener!="undefined"&amp;&amp;(n=findAPI(top.window.opener));</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">apiHandle=n</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">function doLMSInitialize()</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">var n=getAPIHandle();</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">n.LMSInitialize("")</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">function doLMSFinish()</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">var n=getAPIHandle(),t;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(n==null)</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">return"false";</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">t=n.LMSFinish("");</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">t="true"</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">function doLMSCommit()</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">var n=getAPIHandle();</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(n==null)</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">return"false";</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">n.LMSCommit("")</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">function doLMSGetValue(n)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">var t=getAPIHandle(),i,r,u;</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">return t==null?"":(i=t.LMSGetValue(n),r=t.LMSGetLastError().toString(),r!=0?(u=t.LMSGetErrorString(r),alert("LMSGetValue("+n+") failed. \n"+u),""):typeof i=="undefined"||i==null?"":i.toString())</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">function doLMSSetValue(n,t)</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">var i=getAPIHandle();</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">if(i!=null)</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">{</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">i.LMSSetValue(n,t);</span></p><p style="margin:0pt 0pt 0pt 50.4pt"><span style="font-family:'Courier New'; font-size:10.5pt">return</span></p><p style="margin:0pt 0pt 0pt 25.2pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">}</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">var apiHandle=null,findAPITries=0,includeScormApi=!0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">doLMSInitialize()</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">18023716953</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">TFSÕËºÅ  192.168.1.10   yaols  yaols123</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">SVNÕËºÅ  192.168.1.9    yaols  yaols123</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">\\192.168.1.6\YunCompanyAPI</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">Ë®·Ñ205</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">¶©²Í108</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">44</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">78</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">200</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">71</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">106</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">87</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">899</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">132</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">30</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">506</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">1276</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">355+355+320+223-150-544=559</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p><p style="margin:0pt"><span style="font-family:'Courier New'; font-size:10.5pt">&#xa0;</span></p></div></body></html>